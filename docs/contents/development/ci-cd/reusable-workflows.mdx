---
title: Reusable Workflows
sidebar_position: 5
---

import TOCInline from '@theme/TOCInline';

# Reusable Workflows & Template Repository Architecture

![Template Architecture](https://img.shields.io/badge/Architecture-Template%20Based-blue?style=for-the-badge)
![External Workflows](https://img.shields.io/badge/Workflows-External%20Template-green?style=for-the-badge)
![Centralized](https://img.shields.io/badge/Management-Centralized-orange?style=for-the-badge)

The slack-mcp-server CI/CD system leverages a **template repository architecture** using reusable workflows from [`Chisanan232/Template-Python-UV-Project`](https://github.com/Chisanan232/Template-Python-UV-Project). This approach provides standardized, centrally-maintained workflows while promoting consistency, maintainability, and the DRY (Don't Repeat Yourself) principle across all template-based projects.

<TOCInline toc={toc} />

## Template Repository Architecture

The project now uses a **hybrid architecture** combining local project-specific workflows with external template repository workflows:

### **üè† Local Workflows** (Project-Specific)
- **[`rw_build_and_test.yaml`](https://github.com/Chisanan232/slack-mcp-server/blob/master/.github/workflows/rw_build_and_test.yaml)** - Orchestrates test execution
- **[`rw_run_all_test_and_record.yaml`](https://github.com/Chisanan232/slack-mcp-server/blob/master/.github/workflows/rw_run_all_test_and_record.yaml)** - Comprehensive test coordination
- **[`ci.yaml`](https://github.com/Chisanan232/slack-mcp-server/blob/master/.github/workflows/ci.yaml)** & **[`ci_includes_e2e_test.yaml`](https://github.com/Chisanan232/slack-mcp-server/blob/master/.github/workflows/ci_includes_e2e_test.yaml)** - Main CI workflows

### **‚òÅÔ∏è Template Repository Workflows** (Centralized & Maintained)
- **Multi-Python Testing**: `Chisanan232/Template-Python-UV-Project/.github/workflows/rw_uv_run_test_with_multi_py_versions.yaml@master`
- **Coverage Reporting**: `Chisanan232/Template-Python-UV-Project/.github/workflows/rw_organize_test_cov_reports.yaml@master`

### **Architecture Benefits:**
- **‚úÖ Centralized Maintenance**: Core testing workflows maintained in template repository
- **‚úÖ Automatic Updates**: Bug fixes and improvements flow to all template-based projects
- **‚úÖ Local Customization**: Project-specific orchestration and configuration
- **‚úÖ Consistency**: Standardized testing patterns across template ecosystem
- **‚úÖ Reduced Duplication**: Common workflows shared, not duplicated

## Core Reusable Workflows

### 1. Local Build and Test Orchestration ([`rw_build_and_test.yaml`](https://github.com/Chisanan232/slack-mcp-server/blob/master/.github/workflows/rw_build_and_test.yaml))

**Purpose**: **Local orchestration workflow** that coordinates multiple test types using template repository workflows.

**Template Repository Integration:**
```yaml
# Uses external template repository workflows
jobs:
  run_unit-test:
    uses: Chisanan232/Template-Python-UV-Project/.github/workflows/rw_uv_run_test_with_multi_py_versions.yaml@master
    with:
      test_type: unit-test
      test_folder: './test/unit_test'
      python-versions: '["3.13"]'
      operating-systems: '["ubuntu-latest", "ubuntu-22.04", "macos-latest", "macos-14"]'
```

**Key Features**:
- **Template Integration**: Uses centralized workflows from template repository
- **Test Orchestration**: Coordinates unit, integration, contract, E2E, and CI script tests
- **Coverage Organization**: Integrates with template repository coverage workflows
- **Hardcoded Configuration**: Python 3.13 and 4 OS variants for comprehensive testing

### 2. External Multi-Python Testing (Template Repository)

**Source**: `Chisanan232/Template-Python-UV-Project/.github/workflows/rw_uv_run_test_with_multi_py_versions.yaml@master`

**Purpose**: Comprehensive testing across multiple Python versions and operating systems with UV toolchain.

**Matrix Strategy:**
```yaml
uses: ./.github/workflows/rw_uv_run_test_with_multi_py_versions.yaml
with:
  python-versions: '["3.9", "3.10", "3.11", "3.12"]'
  test-type: 'unit'  # or 'integration', 'e2e'
```

**Key Features** (Template Repository Provided):
- **Matrix Testing**: Configurable Python versions and operating systems
- **UV Test Integration**: Uses `uv run` for consistent test environments  
- **Flexible Test Types**: Supports unit, integration, E2E, and contract testing
- **Parameterized Configuration**: Accepts custom Python versions and OS combinations

### 3. External Coverage Organization (Template Repository)

**Source**: `Chisanan232/Template-Python-UV-Project/.github/workflows/rw_organize_test_cov_reports.yaml@master`

**Purpose**: Standardized test coverage reporting and organization from template repository.

**Integration Example:**
```yaml
jobs:
  unit-test_codecov:
    uses: Chisanan232/Template-Python-UV-Project/.github/workflows/rw_organize_test_cov_reports.yaml@master
    with:
      test_type: unit-test
```

**Key Features** (Template Repository Provided):
- **Multi-Format Support**: Generates coverage in XML, HTML, and JSON formats
- **Report Merging**: Combines coverage from multiple test runs and OS variants
- **Artifact Organization**: Structured storage and upload of coverage reports
- **Template Consistency**: Standardized across all template-based projects

### 4. Local Test Coordination ([`rw_run_all_test_and_record.yaml`](https://github.com/Chisanan232/slack-mcp-server/blob/master/.github/workflows/rw_run_all_test_and_record.yaml))

**Purpose**: **Local coordination workflow** that orchestrates the complete CI pipeline using template workflows.

**Template Integration:**
```yaml
jobs:
  build-and-test:
    uses: ./.github/workflows/rw_build_and_test.yaml  # Local orchestrator
    with:
      run_e2e: ${{ inputs.run_e2e }}
```

**Key Features**:
- **Pipeline Orchestration**: Coordinates build, test, and reporting phases
- **Codecov Integration**: Uploads organized coverage reports to Codecov
- **SonarCloud Integration**: Performs code quality analysis
- **Conditional E2E Testing**: Optional end-to-end test execution

## Template Repository Migration Benefits

### **üöÄ Migration Overview**

The project has successfully migrated from **local reusable workflows** to a **template repository architecture**. This migration provides significant benefits:

### **üì¶ Before: Local Workflows**
- ‚ùå Duplicated workflow logic across projects
- ‚ùå Manual maintenance of common testing patterns
- ‚ùå Inconsistent implementations between projects
- ‚ùå Individual bug fixes required per project

### **‚òÅÔ∏è After: Template Repository Architecture**
- ‚úÖ Centralized workflow maintenance in template repository
- ‚úÖ Automatic propagation of improvements and bug fixes
- ‚úÖ Consistent testing patterns across all template-based projects
- ‚úÖ Local customization with global standardization

## Current Architecture Pattern

### **Template Repository Workflow Integration**

The current integration pattern leverages external template workflows:

```yaml
jobs:
  # Local orchestration with template repository workflows
  run_unit-test:
    uses: Chisanan232/Template-Python-UV-Project/.github/workflows/rw_uv_run_test_with_multi_py_versions.yaml@master
    with:
      test_type: unit-test
      test_folder: './test/unit_test'
      python-versions: '["3.13"]'
      operating-systems: '["ubuntu-latest", "ubuntu-22.04", "macos-latest", "macos-14"]'

  unit-test_codecov:
    uses: Chisanan232/Template-Python-UV-Project/.github/workflows/rw_organize_test_cov_reports.yaml@master
    with:
      test_type: unit-test
```

### Multi-Python Testing Pattern

CI workflows integrate multi-version testing for comprehensive compatibility validation:

```yaml
jobs:
  # Main build and test
  build_and_test:
    uses: ./.github/workflows/rw_build_and_test.yaml
    with:
      python-version: '3.11'
  
  # Multi-Python version testing
  test_multi_versions:
    needs: [build_and_test]
    uses: ./.github/workflows/rw_uv_run_test_with_multi_py_versions.yaml
    with:
      python-versions: '["3.9", "3.10", "3.11", "3.12"]'
      test-type: 'unit'
  
  # Comprehensive test execution
  run_all_tests:
    needs: [test_multi_versions]
    uses: ./.github/workflows/rw_run_all_test_and_record.yaml
    with:
      test-suite: 'all'
      record-artifacts: true
  
  # Coverage organization
  organize_coverage:
    needs: [run_all_tests]
    uses: ./.github/workflows/rw_organize_test_cov_reports.yaml
    with:
      coverage-format: 'xml'
      upload-codecov: true
```

### Conditional Execution Patterns

Reusable workflows support conditional execution based on triggers and configurations:

```yaml
jobs:
  # Run comprehensive tests only on main branch
  comprehensive_tests:
    if: github.ref == 'refs/heads/main'
    uses: ./.github/workflows/rw_run_all_test_and_record.yaml
    with:
      test-suite: 'all'
      record-artifacts: true
  
  # Run quick tests on feature branches
  quick_tests:
    if: github.ref != 'refs/heads/main'
    uses: ./.github/workflows/rw_uv_run_test_with_multi_py_versions.yaml
    with:
      python-versions: '["3.11"]'
      test-type: 'unit'
```

## Architecture Benefits

### DRY Principle Implementation

**Before Reusable Workflows**:
- Python build and test logic duplicated across multiple workflows
- Inconsistent test execution patterns
- Divergent coverage reporting implementations
- Maintenance burden across multiple files

**With Reusable Workflows**:
- Single source of truth for build, test, and coverage operations
- Consistent Python version testing across all workflows
- Centralized UV toolchain usage and configuration
- Simplified maintenance and updates

### Consistency Guarantees

**Standardized Operations**:
- All Python builds use identical UV toolchain settings
- Multi-version testing follows the same comprehensive process
- Coverage reporting maintains consistent format and upload patterns
- Test execution uses unified artifact management

### Enhanced Maintainability

**Centralized Logic**:
- UV toolchain improvements benefit all workflows automatically
- Python version updates require changes in single location
- Bug fixes propagate across entire test system
- New testing features available to all consuming workflows

### Improved Testing

**Component Isolation**:
- Each reusable workflow can be tested independently
- Clear separation between build, test, and coverage operations
- Simplified debugging of test failures
- Consistent artifact organization

## Configuration Management

### Parameter Standardization

All reusable workflows follow consistent parameter naming conventions:

```yaml
# Standard parameters across Python workflows
inputs:
  python-version:
    description: 'Python version for operations'
    type: string
    default: '3.11'
  
  uv-version:
    description: 'UV version to use'
    type: string
    default: 'latest'
  
  test-type:
    description: 'Type of tests to run'
    type: string
    default: 'unit'
```

### Secret Management

**Inherited Secrets Pattern**:
```yaml
# Consuming workflows pass all secrets to reusable workflows
secrets: inherit
```

### Permission Management

**Standard Permissions**:
```yaml
permissions:
  contents: read        # Repository access
  actions: read        # Artifact access
  checks: write        # Test result reporting
```

## Best Practices

### For Workflow Consumers

1. **Dependency Order**: Ensure proper `needs` relationships between workflow jobs
2. **Python Version Consistency**: Use consistent Python versions across related jobs
3. **Conditional Logic**: Use appropriate conditions for optional test operations
4. **Artifact Management**: Follow consistent naming for test artifacts
5. **Error Handling**: Handle reusable workflow failures appropriately

### Performance Optimization

**Matrix Strategies**:
```yaml
# Multi-Python version testing with matrix execution
strategy:
  matrix:
    python-version: ['3.9', '3.10', '3.11', '3.12']
    
uses: ./.github/workflows/rw_uv_run_test_with_multi_py_versions.yaml
with:
  python-versions: ${{ toJson(matrix.python-version) }}
```

**Caching Strategies**:
- UV cache for faster dependency installation
- Python package cache for faster builds
- Test artifact caching between workflow runs
- Coverage report caching for incremental analysis

---

üîó **Related Documentation**:
- [Release System](./release-system.mdx) - See how reusable workflows integrate into release pipelines
- [Continuous Integration](./continuous-integration.mdx) - Understanding CI workflow usage
- [Developer Guide](./developer-guide.mdx) - Advanced configuration and troubleshooting
